import{j as e,r as u,a as c,F as S,W as w,g as M,p as I,L as h,T as C,v,B as L,R as E,b as f,c as P,d as j,e as T}from"./vendor.7887550a.js";const q=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}};q();function y({message:t}){return t?e("div",{className:"pt-4",children:e("div",{className:"p-4 bg-red-200 border border-gray-300 text-red-600 text-sm rounded-lg block w-full",children:t})}):null}const b="p-4 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",N="p-4 text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm w-full text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",x=()=>{if(!window.ethereum)throw new Error("No crypto wallet found. Please install it.")},D=async(t,s)=>{var n,l,r;((n=t.message)==null?void 0:n.includes("User denied transaction signature"))?s("You denied transaction signature."):((l=t.message)==null?void 0:l.includes("insufficient funds"))?s("Insufficient funds."):((r=t.message)==null?void 0:r.includes("invalid address"))?s("Please enter a valid address."):(console.log({error:t}),s(t.message))},F=async({address:t,amount:s,setError:n,setTxs:l})=>{try{if(x(),!t)throw new Error("Please enter recipient address.");if(!s||s<=0)throw new Error("Please enter a valid amount.");await window.ethereum.send("eth_requestAccounts");const i=new w(window.ethereum).getSigner();M(t);const a=I(s),o=await i.sendTransaction({to:t,value:a});console.log({address:t,amount:s,amountWei:a,tx:o}),l(d=>[...d,o])}catch(r){D(r,n)}},$=({txs:t})=>t.length===0?null:e(S,{children:t.map((s,n)=>e("div",{className:"alert alert-info mt-5",children:e("div",{className:"flex-1",children:e("label",{children:e("a",{href:`https://ropsten.etherscan.io/tx/${s.hash}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500",children:`TxHash #${n+1}: ${s.hash}`})})})},n))}),A=({userAddress:t})=>{const[s,n]=u.exports.useState(""),[l,r]=u.exports.useState([]);return e("div",{className:"flex flex-col justify-center h-screen p-4",children:e("div",{className:"bg-white rounded-lg shadow-lg p-10 border",children:c("form",{onSubmit:async a=>{if(a.preventDefault(),t){const o=new FormData(a.target);n(""),await F({address:o.get("address"),amount:o.get("amount"),setError:n,setTxs:r}),a.target.reset()}else n("Please connect your wallet first.")},children:[e("div",{className:"flex justify-center",children:e("h1",{className:"text-2xl font-bold",children:"Send ETH payment"})}),e("div",{className:"mb-4",children:e("input",{type:"text",name:"address",className:"p-4 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Recipient Address",required:!0})}),e("div",{className:"mb-4",children:e("input",{type:"text",name:"amount",className:"p-4 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Amount in ETH",required:!0})}),e("button",{type:"submit",className:"p-4 text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm w-full text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Pay now"}),s&&e(y,{message:s}),e($,{txs:l})]})})})},k=()=>e("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:e("h1",{className:"text-3xl font-bold text-gray-900",children:"Home page"})}),H=()=>e("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:e("h1",{className:"text-3xl font-bold text-gray-900",children:"404. Page not found."})}),O=()=>e("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})}),R=()=>e("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),W=({handleLogin:t,handleLogout:s,userAddress:n})=>{const[l,r]=u.exports.useState(!1),[i,a]=u.exports.useState(""),o=u.exports.createRef(),d=()=>{a(n?"Disconnect":"Connect Wallet")},m=()=>{a(n?n.slice(0,6)+"..."+n.slice(n.length-4):"Connect Wallet")};return u.exports.useEffect(()=>{a(n?n.slice(0,6)+"..."+n.slice(n.length-4):"Connect Wallet")},[n]),e("div",{children:c("nav",{className:"bg-gray-800",children:[e("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c("div",{className:"flex items-center justify-between h-16",children:[c("div",{className:"flex items-center",children:[e("div",{className:"flex-shrink-0",children:e(h,{to:"/",className:"flex",children:e("img",{className:'"w-8 h-8 rounded-full',src:"https://avatars.githubusercontent.com/u/56328053?v=4"})})}),e("div",{className:"hidden md:block",children:c("div",{className:"ml-10 flex items-baseline space-x-4",children:[e(h,{to:"/pay",className:" hover:bg-gray-700 text-white px-3 py-2 rounded-md text-sm font-medium",children:"Pay"}),e(h,{to:"/sign",className:" hover:bg-gray-700 text-white px-3 py-2 rounded-md text-sm font-medium",children:"Sign"})]})})]}),e("div",{className:"hidden md:block",children:e("div",{className:"ml-4 flex items-center md:ml-6",children:e("button",{type:"button",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:n?s:t,onMouseOver:d,onMouseLeave:m,children:i})})}),e("div",{className:"-mr-2 flex md:hidden",children:c("button",{onClick:()=>r(!l),type:"button",className:"bg-gray-900 inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white","aria-controls":"mobile-menu","aria-expanded":"false",children:[e("span",{className:"sr-only",children:"Open main menu"}),l?e(R,{}):e(O,{})]})})]})}),e(C,{show:l,enter:"transition ease-out duration-100 transform",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"transition ease-in duration-75 transform",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:()=>e("div",{className:"md:hidden",id:"mobile-menu",children:c("div",{ref:o,className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:[e(h,{to:"/pay",className:" hover:bg-gray-700 text-white block px-3 py-2 rounded-md text-base font-medium",children:"Pay"}),e(h,{to:"/sign",className:" hover:bg-gray-700 text-white block px-3 py-2 rounded-md text-base font-medium",children:"Sign"}),e("button",{type:"button",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 w-full",onClick:n?s:t,onMouseOver:d,onMouseLeave:m,children:i})]})})})]})})},B=async({setError:t,message:s,userAddress:n})=>{try{if(x(),!n)throw new Error("Connect your wallet first.");await window.ethereum.send("eth_requestAccounts");const r=new w(window.ethereum).getSigner(),i=await r.signMessage(s),a=await r.getAddress();return{message:s,signature:i,address:a}}catch(l){t(l.message)}};function V({userAddress:t}){const[s,n]=u.exports.useState([]),[l,r]=u.exports.useState();return e("form",{className:"m-4",onSubmit:async a=>{a.preventDefault();const o=new FormData(a.target);r();const d=await B({setError:r,message:o.get("message"),userAddress:t});d&&n([...s,d])},children:c("div",{className:"credit-card w-full shadow-lg mx-auto rounded-xl bg-white",children:[c("main",{className:"mt-4 p-4 -mb-6",children:[e("h1",{className:"text-xl font-semibold text-gray-700 text-center",children:"Sign messages"}),e("div",{className:"my-3",children:e("input",{required:!0,type:"text",name:"message",className:`textarea h-24 textarea-bordered focus:ring focus:outline-none ${b}`,placeholder:"Message"})})]}),c("footer",{className:"p-4",children:[e("button",{type:"submit",className:N,children:"Sign message"}),e(y,{message:l})]}),s.map((a,o)=>e("div",{className:"p-4",children:c("div",{className:"my-3",children:[c("p",{className:"break-words",children:["Message ",o+1,": ",a.message]}),c("p",{className:"break-words",children:["Signer: ",a.address]}),c("p",{className:"break-words",children:["Signature: ",a.signature]})]})},o))]})})}function _({message:t}){return t?e("div",{className:"pt-4",children:e("div",{className:"p-4 bg-green-200 border border-gray-300 text-green-600 text-sm rounded-lg block w-full",children:t})}):null}const U=async({setError:t,setSuccessMsg:s,message:n,address:l,signature:r,userAddress:i})=>{try{if(x(),!i)throw new Error("Connect your wallet first.");await v(n,r)!==l?t("Signature is not valid."):s("Signature is valid.")}catch(a){t(a.message)}};function K({userAddress:t}){const[s,n]=u.exports.useState(""),[l,r]=u.exports.useState("");return e("form",{className:"m-4",onSubmit:async a=>{a.preventDefault();const o=new FormData(a.target);r(""),n(""),await U({setError:n,setSuccessMsg:r,message:o.get("message"),address:o.get("address"),signature:o.get("signature"),userAddress:t})},children:c("div",{className:"credit-card w-full shadow-lg mx-auto rounded-xl bg-white",children:[c("main",{className:"mt-4 p-4 -mb-6",children:[e("h1",{className:"text-xl font-semibold text-gray-700 text-center",children:"Verify signature"}),c("div",{className:"",children:[e("div",{className:"my-3",children:e("input",{required:!0,type:"text",name:"message",className:`textarea h-24 textarea-bordered focus:ring focus:outline-none ${b}`,placeholder:"Message"})}),e("div",{className:"my-3",children:e("input",{required:!0,type:"text",name:"signature",className:`textarea h-24 textarea-bordered focus:ring focus:outline-none ${b}`,placeholder:"Signature"})}),e("div",{className:"my-3",children:e("input",{required:!0,type:"text",name:"address",className:`textarea h-24 textarea-bordered focus:ring focus:outline-none ${b}`,placeholder:"Signer address"})})]})]}),e("footer",{className:"p-4 -mb-6",children:e("button",{type:"submit",className:N,children:"Verify signature"})}),c("div",{className:"p-4",children:[e(y,{message:s}),e(_,{message:l})]})]})})}const Y=({userAddress:t})=>c("div",{className:"flex flex-wrap",children:[e("div",{className:"w-full lg:w-1/2",children:e(V,{userAddress:t})}),e("div",{className:"w-full lg:w-1/2",children:e(K,{userAddress:t})})]}),z=()=>{const[t,s]=u.exports.useState(""),n=async()=>{try{x();const{signer:o,address:d,chainId:m}=await r(),g=P(),p=await o.signMessage(g);if(console.log({signature:p}),!await v(g,p,d))throw new Error("Invalid signature");if(m!==3)throw new Error("Please connect to Ropsten testnet.");s(d),localStorage.setItem("userAddress",d)}catch(o){alert(o.message)}},l=()=>{s(""),localStorage.removeItem("userAddress")},r=async()=>{const o=new w(window.ethereum,"any");await o.send("eth_requestAccounts",[]);const d=o.getSigner(),m=await d.getAddress(),g=await d.getChainId();return console.log({address:m,chainId:g}),{provider:o,signer:d,address:m,chainId:g}},i=o=>{o!==3&&alert("Please connect to Ropsten testnet.")},a=async()=>{const{provider:o,chainId:d}=await r();i(d),o.on("network",async(m,g)=>{if(g){s(""),localStorage.removeItem("userAddress");const{chainId:p}=await r();i(p)}})};return u.exports.useEffect(async()=>{if(window.ethereum){await a();const o=localStorage.getItem("userAddress");o&&s(o)}else console.log("window.ethereum not found")},[]),c(L,{children:[e(W,{handleLogin:n,handleLogout:l,userAddress:t}),c(E,{children:[e(f,{path:"/",element:e(k,{})}),e(f,{path:"/home",element:e(k,{})}),e(f,{path:"/pay",element:e(A,{userAddress:t})}),e(f,{path:"/sign",element:e(Y,{userAddress:t})}),e(f,{path:"*",element:e(H,{})})]})]})};j.exports.render(e(T.StrictMode,{children:e(z,{})}),document.getElementById("root"));
